{% extends "auctions/layout.html" %}

{% block body %}
    {% if user.is_authenticated %}
        <h2>
            Listing {{ listing.id }}: {{ listing.title }}
            <a href="{% url 'watch' listing.id %}"><img src={% if starred %} "/static/auctions/star-on.svg" {% else %} "/static/auctions/star-off.svg" {% endif %} width="30px" height="30px"/></a>
        </h2>
        <div>
            <p><b>Category:</b> {{ listing.category }}</p>
            <p><b>Listed by:</b> {{ listing.owner }}</p>
            <p><b>Date:</b> {{ listing.creationDate }}</p>
            <img src={{ listing.picture.url }}>
            <p>{{ listing.picture.url }}</p>
            <h3>Description:</h3>
            <p>{{ listing.description }}</p>
            <p><b>Initial price:</b> ${{ listing.initialPrice }}</p>
            <p><b>Current price:</b> ${{ listing.currentPrice }}</p>
        </div>
        <hr>
        <div>
            {% if isowner %}
                <form action="{%url 'finish' %}" method="post">
                    {% csfr_token %}
                    <input type="button" value="Finish auction">
                </form>
            {% else %}
                <form action="{%url 'bid' %}" method="post">
                    {% csfr_token %}
                    {{ form }}
                    <input type="submit" value="Bid">
                </form>
            {% endif %}
        </div>
        <hr>
        <div>
            <h5>Comments:</h5>
            <form action="" method="post">
                {% csrf_token %}
                <table>
                    {{ form.as_table }}
                </table>
                <input type="submit" value="Submit">
            </form>
            <hr>
            {% for comment in comments %}
                <div>
                    <b>{{ comment.user }}</b><i>({{ comment.timestamp }})</i>:
                    <p>{{ comment.comment }}</p>
                </div>
                <hr>
            {% endfor %}
        </div>
    {% endif %}
{% endblock %}